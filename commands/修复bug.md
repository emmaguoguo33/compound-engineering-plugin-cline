---
name: 修复bug
description: Bug修复专用工作流 - 复现、定位、修复、测试、记录
argument-hint: "<bug描述或issue链接>"
---

# 🐛 修复Bug - 专用工作流

系统化的Bug修复流程，确保彻底解决问题并积累经验。

## 触发条件

- `/修复bug <问题描述>`
- `/修复bug #123` (issue编号)
- `/fixbug`
- "修一个bug"
- "这里有个bug"

## 执行流程

### 第1步：Bug信息收集

```markdown
## 🐛 Bug信息

### 问题描述
<input_document> #$ARGUMENTS </input_document>

### 信息收集检查表
- [ ] 问题现象是什么？
- [ ] 期望行为是什么？
- [ ] 如何复现？
- [ ] 影响范围多大？
- [ ] 是否有报错信息？
- [ ] 首次出现时间？
- [ ] 相关的代码变更？
```

### 第2步：复现Bug

```bash
# 1. 创建修复分支
git checkout main && git pull
git checkout -b fix/bug-描述-$(date +%Y%m%d)

# 2. 尝试复现
# 按照描述的步骤操作
# 记录复现结果
```

**复现记录模板**：
```markdown
### 复现步骤
1. 步骤1
2. 步骤2
3. 步骤3

### 复现结果
- ✅ 成功复现 / ❌ 无法复现
- 复现环境: [环境信息]
- 复现频率: [必现/偶现/特定条件]
```

### 第3步：定位问题

```markdown
### 调查过程

#### 初步分析
- 可能的原因1: [描述]
- 可能的原因2: [描述]

#### 排查步骤
1. 检查 [文件/模块]
   - 发现: [发现内容]
2. 检查 [日志/数据]
   - 发现: [发现内容]

#### 根因定位
- **根本原因**: [描述]
- **问题代码**: [文件路径:行号]
- **引入时间**: [commit hash 或日期]
```

**常用调试命令**：
```bash
# 查找可能的问题代码
git log --oneline -20  # 最近提交
git blame <file>       # 代码历史

# 搜索相关代码
grep -r "关键词" .
```

### 第4步：修复实施

```markdown
### 修复方案

#### 方案对比（如有多个）
| 方案 | 优点 | 缺点 | 风险 |
|------|------|------|------|
| 方案A | - | - | - |
| 方案B | - | - | - |

#### 选择方案
- 选择: [方案X]
- 原因: [选择原因]

#### 修改内容
- [ ] 修改文件1: [变更说明]
- [ ] 修改文件2: [变更说明]
- [ ] 添加测试: [测试说明]
```

### 第5步：测试验证

```markdown
### 测试清单

#### 基本验证
- [ ] Bug不再复现
- [ ] 原有功能正常
- [ ] 相关功能不受影响

#### 边界测试
- [ ] 边界条件1
- [ ] 边界条件2
- [ ] 异常输入处理

#### 回归测试
- [ ] 运行相关测试套件
- [ ] 手动测试关键路径
```

```bash
# 运行测试
npm test
# 或
python -m pytest
# 或
bin/rails test
```

### 第6步：提交修复

```bash
git add .
git commit -m "fix(模块): 修复[问题简述]

问题: [问题描述]
原因: [根本原因]
修复: [修复方法]

Fixes #123 (如果有issue)

🤖 Generated with Claude Code"

git push -u origin fix/bug-描述-$(date +%Y%m%d)
```

### 第7步：复利记录

```markdown
### 💡 经验记录

#### 问题类型
- [ ] 逻辑错误
- [ ] 边界条件
- [ ] 并发问题
- [ ] 配置错误
- [ ] 依赖问题
- [ ] 其他: ____

#### 根因分类
- [ ] 代码缺陷
- [ ] 设计缺陷
- [ ] 测试不足
- [ ] 文档不清
- [ ] 需求变更

#### 预防措施
- [措施1]
- [措施2]

#### 知识沉淀
保存到: skills/[相关技能]/references/bug-fix-[类型].md
```

## Bug修复报告

```markdown
# 🐛 Bug修复报告

## 基本信息
- Bug ID: #123
- 严重程度: [Critical/High/Medium/Low]
- 修复分支: fix/xxx
- 修复人: [姓名]
- 修复时间: YYYY-MM-DD

## 问题描述
[问题现象]

## 根本原因
[根因分析]

## 修复方案
[实施方案]

## 测试验证
- [x] 单元测试通过
- [x] 集成测试通过
- [x] 手动验证通过

## 影响范围
- 影响模块: [模块列表]
- 需要回归: [是/否]

## 经验教训
- 学到的: [经验]
- 可改进的: [建议]

---
由复利插件生成 | {时间戳}
```

## 快速修复模式

对于简单、明确的Bug：

```
/修复bug --quick <描述>

简化流程:
1. 创建分支
2. 直接修复
3. 基本测试
4. 提交
```

## 与其他命令配合

| 命令 | 配合方式 |
|------|---------|
| `/reproduce-bug` | 详细的复现流程 |
| `/workflows:review` | 修复后代码审查 |
| `/workflows:compound` | 记录修复经验 |
| `/test-browser` | UI相关Bug验证 |

## 复利效应

**Bug修复知识积累**：
```
第1次遇到某类Bug: 2小时排查
第2次类似Bug: 30分钟（有经验）
第N次: 10分钟（直接定位）
```

---

**记住**：每个Bug都是学习机会，修完要记录！🎯
